var suara,myTimeout,msg=new SpeechSynthesisUtterance;function myTimer(){speechSynthesis.pause(),speechSynthesis.resume(),myTimeout=setTimeout(myTimer,1e4)}function ambil_antrian(e){$.ajax({type:"get",url:base_url+"antrian/tambah/"+e,dataType:"json",beforeSend:function(){$(".loader2").show()},success:function(a){1!=a.success?alert("gagal ambil nomor antrian"):print?cetak(a.no,e):($(".loader2").hide(),$(".modal-title").text("Nomor antrian anda "+a.no),$("#modal").modal("show"),setTimeout((()=>{$("#modal").modal("hide")}),5e3))},error:function(e){console.log(e.responseText),alert("ada kesalahan, harap refresh halaman")},complete:function(){}})}function cetak(e,a){let n;switch(a){case"pengaduan":n="Pengaduan";break;case"produk":n="Produk";break;case"ecourt":n="E-Court";break;case"prioritas":n="Prioritas";break;default:n="Entahlah"}console.log("ini kode : "+a),console.log("ini layanan : "+n),$.ajax({type:"POST",url:base_url+"antrian/cetak",data:{no:e,layanan:n},dataType:"json",beforeSend:function(){},success:function(e){1==e.success||alert("gagal kirim data ke printer")},error:function(e,a,n){console.log(e),console.log(a.status),console.log(n),console.log(e.responseText)},complete:function(){$(".loader2").hide(),$(".modal-title").text("Nomor antrian anda "+e),$("#modal").modal("show"),setTimeout((()=>{$("#modal").modal("hide")}),5e3)}})}function cek_panggil(){$.ajax({type:"get",url:base_url+"antrian/panggil_antrian",dataType:"json",success:function(e){1==e.success?memanggil_antrian(e.id,e.no,e.layanan,e.pengumuman):setTimeout((()=>{cek_panggil()}),3e3)},error:function(e){console.log(e.responseText)}})}function memanggil_antrian(e,a,n,t){let o;o=null!=t?t:"Dipanggil nomor antrian "+a+". Silahkan ke loket "+n,0!=rsvc?responsiveVoice.speak(o,voice,{rate:.9,onend:function(){hapus_panggil_antrian(e)}}):(myTimeout=setTimeout(myTimer,1e4),msg.text=o,msg.onend=function(){hapus_panggil_antrian(e)},speechSynthesis.speak(msg))}function hapus_panggil_antrian(e){$.ajax({type:"post",url:base_url+"antrian/hapus_panggil_antrian",data:{id:e},dataType:"json",success:function(e){1==e.success&&setTimeout(cek_panggil,3e3)},complete:function(){}})}function hilangkan(){cek_panggil(),$(".rvNotification").remove()}function load_tutup(){$.ajax({type:"GET",url:base_url+"setting/get_jam_tutup",dataType:"TEXT",success:function(e){cek_tutup(e)},error:function(e){confirm("Ada kesalahan, silahkan refresh")&&location.reload()}})}function cek_tutup(e){try{var a=new Date,n=new Date,t=e.split(":");n.setHours(t[0],t[1],0),n.getHours()==a.getHours()?n.getMinutes()<a.getMinutes()&&(responsiveVoice.isPlaying()||window.location.replace(base_url+"tutup")):n.getHours()<a.getHours()&&(responsiveVoice.isPlaying()||window.location.replace(base_url+"tutup"))}catch(e){confirm("Ada kesalahan, silahkan refresh")&&location.reload()}setTimeout((()=>{cek_tutup(e)}),3e4)}0==rsvc&&setTimeout((()=>{suara=window.speechSynthesis.getVoices(),msg.voice=suara[11],msg.lang="in-ID",msg.rate=.9}),1e3);